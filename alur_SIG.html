<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dasbor Interaktif - Alur Proses SIG Desa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Desa Harmoni -->
    <!-- Application Structure Plan: Aplikasi ini dirancang dengan struktur tematik yang berpusat pada alur proses. Struktur utamanya adalah visualisasi alur kerja interaktif yang dibagi menjadi tiga tahap (Pengumpulan, Pengelolaan, Pemanfaatan) menggunakan sistem tab untuk memudahkan navigasi. Setiap langkah dalam alur dapat diklik untuk menampilkan detailnya, mengubah diagram statis menjadi alat eksplorasi. Struktur ini dipilih karena laporan sumber adalah tentang PROSES, bukan kumpulan data statis. Tujuannya adalah agar pengguna dapat 'berjalan' melalui alur kerja secara virtual. Untuk memberikan konteks hasil akhir dari proses ini, sebuah bagian 'Dasbor Analitik' ditambahkan untuk mensimulasikan bagaimana data yang dikumpulkan dapat divisualisasikan dan digunakan untuk pengambilan keputusan, lengkap dengan filter interaktif. Ini mengubah laporan dari 'apa yang harus dilakukan' menjadi 'inilah yang bisa Anda capai'. -->
    <!-- Visualization & Content Choices: 1. Alur Proses (Tahap 1, 2, 3): Report Info -> Langkah-langkah proses bisnis. Goal -> Mengorganisir dan menjelaskan alur. Viz/Method -> Diagram alur interaktif dibangun dengan HTML/CSS (divs, borders, flexbox) karena larangan SVG/Mermaid. Interaction -> Klik pada setiap langkah untuk menampilkan detail (Aktor, Aktivitas, Output) di panel samping. Justification -> Paling efektif untuk memvisualisasikan urutan proses secara bersih dan interaktif. 2. Aktor Utama: Report Info -> Daftar aktor yang terlibat. Goal -> Menginformasikan siapa saja yang berperan. Viz/Method -> Kartu informasi sederhana dengan ikon. Interaction -> Statis. Justification -> Memberi konteks peran dengan cepat. 3. Dasbor Analitik (Kondisi Aset & Prioritas Pembangunan): Report Info -> Contoh pemanfaatan data (analisis aset, perencanaan). Goal -> Mendemonstrasikan hasil akhir dari proses SIG. Viz/Method -> Donut Chart & Bar Chart menggunakan Chart.js (Canvas). Interaction -> Filter dropdown untuk mengubah data chart (simulasi). Justification -> Visualisasi data adalah cara paling berdampak untuk menunjukkan nilai SIG, dan interaktivitas filter menunjukkan kekuatan analitiknya. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f5; /* Zinc 100 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .flow-step.active {
            border-color: #16a34a; /* Green 600 */
            background-color: #f0fdf4; /* Green 50 */
            transform: scale(1.03);
        }
        .tab-btn.active {
            border-color: #16a34a;
            background-color: #16a34a;
            color: white;
        }
        .map-point {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .map-point:hover {
            transform: scale(1.5);
        }
        .map-popup {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            width: 250px;
            z-index: 10;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-7xl">
        
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Dasbor Interaktif Alur Proses SIG Desa</h1>
            <p class="mt-2 text-lg text-gray-600">Visualisasi Proses Transformasi Data Menjadi Informasi Strategis</p>
        </header>

        <main>
            <section id="introduction" class="mb-12 bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-3 text-gray-900">Tujuan Sistem Informasi Geografis (SIG) Desa</h2>
                <p class="text-gray-700 leading-relaxed">
                    Aplikasi ini memvisualisasikan alur proses bisnis dari Sistem Informasi Geografis (SIG) Desa, sebuah platform digital yang bertujuan untuk memetakan, mengelola, dan menganalisis semua aset serta data desa secara spasial. Tujuannya adalah mengubah data mentah menjadi informasi strategis yang mendukung perencanaan pembangunan yang lebih akurat, pengelolaan aset yang efektif, dan peningkatan transparansi layanan publik. Jelajahi setiap tahapan untuk memahami bagaimana data dikumpulkan, diolah, dan akhirnya dimanfaatkan untuk kemajuan desa.
                </p>
            </section>
            
            <section id="core-system" class="mb-12">
                <h2 class="text-2xl font-bold mb-6 text-center text-gray-900">Inti Sistem: Peta Digital Interaktif</h2>
                 <p class="text-center text-gray-600 mb-8 max-w-3xl mx-auto">Ini adalah simulasi peta digital yang menjadi inti dari SIG. Anda dapat mengaktifkan berbagai lapisan data dan mengklik titik-titik di peta untuk melihat informasi deskriptif yang terhubung dengan setiap objek.</p>
                <div class="bg-white p-6 rounded-lg shadow-md grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="md:col-span-1">
                        <h3 class="font-bold text-lg mb-4">Lapisan Data (Layer)</h3>
                        <div class="space-y-3">
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" class="layer-toggle h-5 w-5 rounded border-gray-300 text-green-600 focus:ring-green-500" data-layer="batas-desa" checked>
                                <span class="text-gray-700">Batas Desa</span>
                            </label>
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" class="layer-toggle h-5 w-5 rounded border-gray-300 text-green-600 focus:ring-green-500" data-layer="jalan" checked>
                                <span class="text-gray-700">Jalan</span>
                            </label>
                             <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" class="layer-toggle h-5 w-5 rounded border-gray-300 text-green-600 focus:ring-green-500" data-layer="bangunan" checked>
                                <span class="text-gray-700">Bangunan</span>
                            </label>
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" class="layer-toggle h-5 w-5 rounded border-gray-300 text-green-600 focus:ring-green-500" data-layer="lahan" checked>
                                <span class="text-gray-700">Lahan Pertanian</span>
                            </label>
                        </div>
                    </div>
                    <div class="md:col-span-3 h-96 bg-gray-200 rounded-lg relative overflow-hidden" id="map-container">
                        <div class="absolute inset-0 bg-cover bg-center opacity-50" style="background-image: url('https://placehold.co/800x600/e2e8f0/64748b?text=Peta+Dasar+Desa');"></div>
                        
                        <div id="layer-batas-desa" class="absolute inset-0 border-4 border-dashed border-gray-500 rounded-lg"></div>
                        <div id="layer-jalan" class="absolute inset-0">
                             <div class="absolute bg-gray-400 h-1.5" style="width: 60%; top: 30%; left:0;"></div>
                             <div class="absolute bg-gray-400 w-1.5" style="height: 70%; top: 30%; left:40%;"></div>
                        </div>
                        <div id="layer-bangunan" class="absolute inset-0">
                            <div class="map-point bg-blue-600" style="top: 25%; left: 35%;" data-info-id="bangunan1"></div>
                            <div class="map-point bg-blue-600" style="top: 50%; left: 60%;" data-info-id="bangunan2"></div>
                        </div>
                        <div id="layer-lahan" class="absolute inset-0">
                             <div class="map-point bg-yellow-500" style="top: 70%; left: 15%;" data-info-id="lahan1"></div>
                        </div>

                        <div id="map-popup" class="map-popup">
                            <button id="popup-close" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">&times;</button>
                            <div id="popup-content"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="process-flow" class="mb-12">
                <h2 class="text-2xl font-bold mb-6 text-center text-gray-900">Alur Proses Bisnis Interaktif</h2>
                
                <div class="flex justify-center mb-6 border-b border-gray-200">
                    <nav class="flex space-x-2" aria-label="Tabs">
                        <button class="tab-btn active" data-tab="1">Tahap 1: Pengumpulan Data</button>
                        <button class="tab-btn" data-tab="2">Tahap 2: Pengelolaan & Analisis</button>
                        <button class="tab-btn" data-tab="3">Tahap 3: Pemanfaatan Informasi</button>
                    </nav>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div id="flow-diagram" class="lg:col-span-2">
                    </div>
                    
                    <div id="flow-details" class="bg-white p-6 rounded-lg shadow-md h-fit sticky top-8">
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Detail Langkah</h3>
                        <div id="details-content">
                            <p class="text-gray-500">Klik pada salah satu langkah di diagram untuk melihat detailnya di sini.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="actors" class="mb-12">
                <h2 class="text-2xl font-bold mb-6 text-center text-gray-900">Aktor Utama dalam Sistem</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="actor-card">
                        <span class="text-3xl">⚙️</span>
                        <h3 class="font-bold">Admin/Operator SIG</h3>
                        <p>Bertanggung jawab atas input, validasi, dan pengelolaan data harian.</p>
                    </div>
                    <div class="actor-card">
                        <span class="text-3xl">🏛️</span>
                        <h3 class="font-bold">Pemerintah Desa</h3>
                        <p>Pengguna utama informasi untuk pengambilan keputusan dan perencanaan.</p>
                    </div>
                    <div class="actor-card">
                        <span class="text-3xl">👥</span>
                        <h3 class="font-bold">Masyarakat Umum</h3>
                        <p>Penerima manfaat dari transparansi data dan akses informasi publik.</p>
                    </div>
                    <div class="actor-card">
                        <span class="text-3xl">📈</span>
                        <h3 class="font-bold">Pemerintah Supra-Desa</h3>
                        <p>Membutuhkan laporan dan data agregat untuk koordinasi regional.</p>
                    </div>
                </div>
            </section>

            <section id="dashboard-analytics" class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-2 text-center text-gray-900">Contoh Dasbor Analitik</h2>
                <p class="text-center text-gray-600 mb-8">Ini adalah contoh bagaimana data yang terkumpul dapat divisualisasikan untuk mendukung keputusan.</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="text-lg font-semibold mb-3 text-center">Kondisi Aset Desa</h3>
                         <div class="flex justify-center gap-4 mb-4">
                            <select id="asset-filter" class="filter-dropdown">
                                <option value="all">Semua Aset</option>
                                <option value="jalan">Jalan</option>
                                <option value="irigasi">Irigasi</option>
                                <option value="bangunan">Bangunan</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="assetChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold mb-3 text-center">Skala Prioritas Pembangunan</h3>
                        <div class="flex justify-center gap-4 mb-4">
                            <select id="priority-filter" class="filter-dropdown">
                                <option value="2025">Tahun 2025</option>
                                <option value="2026">Tahun 2026</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="priorityChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center mt-12 py-6 border-t border-gray-200">
            <p class="text-gray-500">Aplikasi Visualisasi Interaktif &copy; 2025</p>
        </footer>

    </div>

    <script>
        const processData = {
            tahap1: [
                { id: '1.1', title: 'Persiapan Peta Dasar', actor: 'Admin/Operator', activity: 'Mengunggah peta dasar (citra satelit, Peta Rupabumi Indonesia) dan batas administrasi resmi desa.', output: 'Peta dasar dan batas wilayah desa termuat dan menjadi kanvas kerja digital.', notes: 'Data ini menjadi referensi utama untuk semua objek yang akan dipetakan.' },
                { id: '1.2', title: 'Survei & Pengumpulan Data', actor: 'Admin/Operator', activity: 'Mengumpulkan data spasial (koordinat GPS) dan data atribut (foto, kondisi, ukuran) dari berbagai objek.', output: 'Data mentah spasial dan non-spasial (tekstual, numerik, foto).', notes: 'Contoh: Titik lokasi jalan rusak, data pemilik lahan, data keluarga miskin.' },
                { id: '1.3', title: 'Input Data ke Sistem', actor: 'Admin/Operator', activity: 'Memasukkan data hasil survei ke dalam aplikasi SIG melalui formulir digital.', output: 'Data aset, kependudukan, dan potensi desa tersimpan secara digital di database.', notes: 'Idealnya bisa dilakukan melalui aplikasi web di kantor atau mobile di lapangan.' }
            ],
            tahap2: [
                { id: '2.1', title: 'Validasi & Verifikasi Data', actor: 'Admin/Operator', activity: 'Memeriksa kelengkapan dan kebenaran data yang telah diinput. Sistem membantu menandai data yang tidak lengkap.', output: 'Data yang terverifikasi, bersih, dan siap untuk dianalisis.', notes: 'Langkah krusial untuk memastikan kualitas dan keandalan informasi.' },
                { id: '2.2', title: 'Analisis Spasial', actor: 'Pemerintah Desa / Admin', activity: 'Menggunakan fitur analisis untuk memetakan potensi dan kebutuhan wilayah.', output: 'Peta tematik, statistik, dan laporan hasil analisis.', notes: 'Contoh: Overlay peta kemiskinan & air bersih, Query jalan rusak, Buffering area pasar.' },
                { id: '2.3', title: 'Pembaruan Data Berkala', actor: 'Admin/Operator', activity: 'Melakukan pembaruan data secara rutin jika ada perubahan kondisi di lapangan.', output: 'Database SIG yang selalu relevan dan up-to-date.', notes: 'Contoh: Mengubah status jalan dari "Rusak" menjadi "Baik" setelah diperbaiki.' }
            ],
            tahap3: [
                { id: '3.1', title: 'Dasar Pengambilan Keputusan', actor: 'Pemerintah Desa', activity: 'Menggunakan hasil analisis sebagai dasar dalam Musyawarah Perencanaan Pembangunan Desa (Musrenbangdes).', output: 'Dokumen perencanaan (RKPDes, APBDes) yang berbasis data akurat.', notes: 'Contoh: Memprioritaskan perbaikan jalan di dusun dengan tingkat kerusakan tertinggi.' },
                { id: '3.2', title: 'Inventarisasi & Monitoring Aset', actor: 'Pemerintah Desa', activity: 'Mengakses database aset untuk memonitor kondisi, menjadwalkan pemeliharaan, dan inventarisasi.', output: 'Laporan kondisi aset, jadwal pemeliharaan, dan neraca aset desa.', notes: 'Contoh: Sistem mengingatkan jadwal pemeliharaan pompa air.' },
                { id: '3.3', title: 'Akses Informasi Publik', actor: 'Masyarakat Umum', activity: 'Mengunjungi portal web SIG Desa untuk melihat peta interaktif, program pemerintah, dan potensi desa.', output: 'Peningkatan transparansi, partisipasi publik, dan kesadaran warga.', notes: 'Warga bisa melihat rencana pembangunan atau melaporkan kerusakan fasilitas.' },
                { id: '3.4', title: 'Pelaporan & Layanan Administrasi', actor: 'Pemerintah Desa / Admin', activity: 'Menghasilkan laporan terstandar untuk pemerintah supra-desa atau mempercepat layanan administrasi.', output: 'Laporan yang cepat dan terstandarisasi, serta pelayanan yang lebih efisien.', notes: 'Contoh: Ekspor data infrastruktur untuk laporan bulanan ke kecamatan.' }
            ]
        };
        
        const mapInfoData = {
            bangunan1: {
                title: 'Balai Desa',
                type: 'Fasilitas Umum',
                content: 'Kantor pusat administrasi desa. Berfungsi sebagai tempat pertemuan warga dan pelayanan publik.'
            },
            bangunan2: {
                title: 'Puskesmas Pembantu',
                type: 'Fasilitas Kesehatan',
                content: 'Memberikan layanan kesehatan dasar bagi masyarakat di Dusun Melati.'
            },
            lahan1: {
                title: 'Sawah Bpk. Subarjo',
                type: 'Lahan Pertanian',
                content: 'Luas: 2 Ha. Jenis tanaman: Padi. Status: Milik pribadi.'
            }
        };

        const flowDiagramContainer = document.getElementById('flow-diagram');
        const detailsContent = document.getElementById('details-content');
        const tabButtons = document.querySelectorAll('.tab-btn');

        function createFlowStep(step) {
            return `
                <div class="flow-step" data-step-id="${step.id}">
                    <div class="flex items-center space-x-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-green-100 text-green-700 rounded-full flex items-center justify-center font-bold text-lg">${step.id}</div>
                        <div>
                            <h4 class="font-bold text-gray-900">${step.title}</h4>
                            <p class="text-sm text-gray-500">Aktor: ${step.actor}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function createArrow() {
            return '<div class="arrow-container"><div class="arrow-down">↓</div></div>';
        }

        function displayFlow(tahap) {
            const steps = processData[`tahap${tahap}`];
            let content = '<div class="space-y-4">';
            steps.forEach((step, index) => {
                content += createFlowStep(step);
                if (index < steps.length - 1) {
                    content += createArrow();
                }
            });
            content += '</div>';
            flowDiagramContainer.innerHTML = content;
            addStepEventListeners();
        }
        
        function displayDetails(stepId) {
            const [tahap, index] = [stepId.split('.')[0], parseInt(stepId.split('.')[1]) - 1];
            const step = processData[`tahap${tahap}`][index];
            
            if (step) {
                detailsContent.innerHTML = `
                    <h4 class="text-lg font-bold text-green-700 mb-2">${step.id}. ${step.title}</h4>
                    <div class="space-y-3 text-sm">
                        <p><strong class="font-semibold text-gray-700">Aktor:</strong> ${step.actor}</p>
                        <p><strong class="font-semibold text-gray-700">Aktivitas:</strong> ${step.activity}</p>
                        <p><strong class="font-semibold text-gray-700">Output:</strong> ${step.output}</p>
                        <p class="mt-2 p-2 bg-gray-100 rounded-md"><strong class="font-semibold text-gray-700">Keterangan:</strong> ${step.notes}</p>
                    </div>
                `;
            }
        }

        function addStepEventListeners() {
            document.querySelectorAll('.flow-step').forEach(stepEl => {
                stepEl.addEventListener('click', () => {
                    document.querySelectorAll('.flow-step').forEach(el => el.classList.remove('active'));
                    stepEl.classList.add('active');
                    const stepId = stepEl.getAttribute('data-step-id');
                    displayDetails(stepId);
                });
            });
        }

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const tab = button.getAttribute('data-tab');
                displayFlow(tab);
                detailsContent.innerHTML = '<p class="text-gray-500">Klik pada salah satu langkah di diagram untuk melihat detailnya di sini.</p>';
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            displayFlow('1');
            
            const initialStep = document.querySelector('.flow-step');
            if(initialStep) {
                initialStep.classList.add('active');
                displayDetails(initialStep.getAttribute('data-step-id'));
            }

            const assetData = {
                all: [350, 120, 50],
                jalan: [150, 80, 40],
                irigasi: [120, 30, 5],
                bangunan: [80, 10, 5]
            };

            const priorityData = {
                2025: [8, 9, 6, 7],
                2026: [7, 8, 8, 9]
            };

            const assetCtx = document.getElementById('assetChart').getContext('2d');
            const assetChart = new Chart(assetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Kondisi Baik', 'Rusak Ringan', 'Rusak Berat'],
                    datasets: [{
                        label: 'Kondisi Aset',
                        data: assetData.all,
                        backgroundColor: ['#22c55e', '#facc15', '#ef4444'],
                        borderColor: '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + ' unit';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const priorityCtx = document.getElementById('priorityChart').getContext('2d');
            const priorityChart = new Chart(priorityCtx, {
                type: 'bar',
                data: {
                    labels: ['Dusun A', 'Dusun B', 'Dusun C', 'Dusun D'],
                    datasets: [{
                        label: 'Skala Prioritas (1-10)',
                        data: priorityData[2025],
                        backgroundColor: '#16a34a',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 10 }
                    },
                    plugins: {
                        legend: { display: false },
                         tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Prioritas: ${context.parsed.y}`;
                                }
                            }
                        }
                    }
                }
            });
            
            document.getElementById('asset-filter').addEventListener('change', (e) => {
                assetChart.data.datasets[0].data = assetData[e.target.value];
                assetChart.update();
            });

            document.getElementById('priority-filter').addEventListener('change', (e) => {
                priorityChart.data.datasets[0].data = priorityData[e.target.value];
                priorityChart.update();
            });

            document.querySelectorAll('.layer-toggle').forEach(toggle => {
                toggle.addEventListener('change', (e) => {
                    const layerId = `layer-${e.target.dataset.layer}`;
                    const layerElement = document.getElementById(layerId);
                    if (layerElement) {
                        layerElement.style.display = e.target.checked ? '' : 'none';
                    }
                });
            });

            const popup = document.getElementById('map-popup');
            const popupContent = document.getElementById('popup-content');
            const popupClose = document.getElementById('popup-close');

            document.querySelectorAll('.map-point').forEach(point => {
                point.addEventListener('click', (e) => {
                    const infoId = e.target.dataset.infoId;
                    const data = mapInfoData[infoId];
                    if (data) {
                        popupContent.innerHTML = `
                            <h4 class="font-bold text-md mb-1">${data.title}</h4>
                            <p class="text-sm text-gray-500 mb-2">${data.type}</p>
                            <p class="text-sm text-gray-800">${data.content}</p>
                        `;
                        popup.style.left = `${e.clientX + 15}px`;
                        popup.style.top = `${e.clientY - popup.offsetHeight / 2}px`;
                        popup.style.display = 'block';
                    }
                });
            });

            popupClose.addEventListener('click', () => {
                popup.style.display = 'none';
            });
            
            document.getElementById('map-container').addEventListener('click', (e) => {
                if (e.target.id === 'map-container' || e.target.closest('#layer-batas-desa') || e.target.closest('#layer-jalan')) {
                    popup.style.display = 'none';
                }
            });

            const style = document.createElement('style');
            style.textContent = `
                .tab-btn { padding: 0.5rem 1rem; border-radius: 0.5rem; border: 2px solid transparent; font-weight: 600; color: #374151; transition: all 0.2s ease-in-out; }
                .tab-btn:hover { background-color: #f3f4f6; }
                .flow-step { background-color: white; padding: 1rem; border-radius: 0.75rem; border: 2px solid #e5e7eb; cursor: pointer; transition: all 0.2s ease-in-out; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1); }
                .flow-step:hover { border-color: #a3e635; transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
                .arrow-container { text-align: center; color: #9ca3b0; font-size: 1.5rem; line-height: 1; margin: -0.5rem 0; }
                .actor-card { background-color: #ffffff; padding: 1.5rem; border-radius: 0.75rem; text-align: center; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); }
                .actor-card h3 { margin-top: 0.75rem; font-size: 1.125rem; color: #1f2937; }
                .actor-card p { margin-top: 0.25rem; color: #4b5563; font-size: 0.875rem; }
                .filter-dropdown { padding: 0.5rem 1rem; border-radius: 0.5rem; border: 1px solid #d1d5db; background-color: #fff; font-weight: 500; }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
